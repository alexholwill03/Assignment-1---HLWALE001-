[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Assignment 1",
    "section": "",
    "text": "Github repository URL: https://alexholwill03.github.io/Assignment-1—HLWALE001-/\n\n# Practical 1 Questions\n# Question 1 \n\ndata(airquality)\nwhich(is.na(airquality))\n\n [1]   5  10  25  26  27  32  33  34  35  36  37  39  42  43  45  46  52  53  54\n[20]  55  56  57  58  59  60  61  65  72  75  83  84 102 103 107 115 119 150 158\n[39] 159 164 180 249 250 251\n\n\n\n# Question 2\n\nmean(airquality$Temp)\n\n[1] 77.88235\n\nsd(airquality$Temp)\n\n[1] 9.46527\n\nmin(airquality$Temp)\n\n[1] 56\n\nmax(airquality$Temp)\n\n[1] 97\n\nmean(airquality$Ozone, na.rm = TRUE)\n\n[1] 42.12931\n\nsd(airquality$Ozone, na.rm = TRUE)\n\n[1] 32.98788\n\nmin(airquality$Ozone, na.rm = TRUE)\n\n[1] 1\n\nmax(airquality$Ozone, na.rm = TRUE)\n\n[1] 168\n\n\n\n# Question 3\n\ndata(cars)\n\nX = cars$speed\nY = cars$dist\n\nX_1 = cbind(1, X) \n\nB = solve((t(X_1)%*%X_1))%*%t(X_1)%*%Y\nB\n\n        [,1]\n  -17.579095\nX   3.932409\n\n\n\n# Question 4\n\nlm(Y ~ X)\n\n\nCall:\nlm(formula = Y ~ X)\n\nCoefficients:\n(Intercept)            X  \n    -17.579        3.932  \n\n\nQuestion 4\n\n# Day 3 Practical Questions 4 and 5\n# Question 4\n\nx_values &lt;- runif(1000, min = -2, max = 2) # -2 &lt;= x &lt;= 2\nf &lt;- sin(x_values)\nplot(x_values,\n     f, \n     cex = 0.5, #making circle size smaller\n     pch = 16, # co-ordinates plotted as a closed circle\n     xlab = 'x', # re-labelling axes\n     ylab = 'y',\n     col = 'red' # plotted co-ordinates are now red\n     )\n\n\n\n\n\n# Question 5\n\nt_data &lt;- rt(1000, 1)\ny &lt;- sort(t_data)\n\n\nn_data_sorted &lt;- replicate(1000, sort(rnorm(1000)))\nx &lt;- rowMeans(n_data_sorted)\n\nlower &lt;- apply(n_data_sorted, 1, quantile, probs = 0.025)\nupper &lt;- apply(n_data_sorted, 1, quantile, probs = 0.975)\n\nplot(x, y,\n     pch = 16, cex = 0.5,\n     xlab = \"norm quantiles\",\n     ylab = \"t-values\",\n     main = \"QQ plot\",\n     xlim = c(-5, 5),\n     ylim = c(-5, 5))\nlines(x, lower, lty = 2, col='blue') # lower envelope\nlines(x, upper, lty = 2, col='blue') # upper envelope\n\n\n\n\n\n# Practical 4\n# Setup\n\n# Install tidyverse if not already installed\nif (!requireNamespace(\"tidyverse\", quietly = TRUE)) {\n  install.packages(\"tidyverse\")\n}\nlibrary(tidyverse)\n\n# Install and load nycflights13 for flight data\nif (!requireNamespace(\"nycflights13\", quietly = TRUE)) {\n  install.packages(\"nycflights13\")\n}\nlibrary(nycflights13)\n\n\n# Question 1\n\ndf &lt;- flights\nclass(df) #checking class\n\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n\ndf &lt;- as_tibble(df)\nclass(df) #changed to tibble, in our case it was already a tibble so unnecessary\n\n[1] \"tbl_df\"     \"tbl\"        \"data.frame\"\n\nhead(df)\n\n# A tibble: 6 × 19\n   year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time\n  &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;\n1  2013     1     1      517            515         2      830            819\n2  2013     1     1      533            529         4      850            830\n3  2013     1     1      542            540         2      923            850\n4  2013     1     1      544            545        -1     1004           1022\n5  2013     1     1      554            600        -6      812            837\n6  2013     1     1      554            558        -4      740            728\n# ℹ 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,\n#   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,\n#   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;\n\n\n\n# Question 2\n\nflights %&gt;%\n  filter(month == 1) %&gt;%\n  group_by(carrier) %&gt;%\n  summarise(\n    mean_distance = mean(distance, na.rm = TRUE),\n    sd_distance = sd(distance, na.rm = TRUE)\n  ) %&gt;%\n  arrange(mean_distance)\n\n# A tibble: 16 × 3\n   carrier mean_distance sd_distance\n   &lt;chr&gt;           &lt;dbl&gt;       &lt;dbl&gt;\n 1 YV               229          0  \n 2 9E               476.       334. \n 3 EV               522.       294. \n 4 US               536.       553. \n 5 MQ               566.       223. \n 6 FL               691.       142. \n 7 OO               733         NA  \n 8 WN               942.       496. \n 9 B6              1062.       681. \n10 DL              1220.       644. \n11 AA              1350.       626. \n12 UA              1462.       778. \n13 F9              1620          0  \n14 AS              2402          0  \n15 VX              2495.        98.2\n16 HA              4983          0  \n\n\n\n# Question 3\n\ncarrier_oo = df %&gt;%\n  filter(carrier == 'OO', month == 1)\n\ncarrier_oo$distance\n\n[1] 733\n\nclass(carrier_oo$distance)\n\n[1] \"numeric\"\n\nlength(carrier_oo$distance)\n\n[1] 1\n\nsd(carrier_oo$distance)\n\n[1] NA\n\ncarrier_YV = df %&gt;%\n  filter(carrier == 'YV', month == 1)\n\ncarrier_YV$distance\n\n [1] 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229\n[20] 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229 229\n[39] 229 229 229 229 229 229 229 229\n\nclass(carrier_YV$distance)\n\n[1] \"numeric\"\n\nlength(carrier_YV$distance)\n\n[1] 46\n\nsd(carrier_YV$distance)\n\n[1] 0\n\n\nThe standard deviation is NA for carrier OO because the length of the distance vector for January is 1, and using the built in ‘sd’ command returns NA for 1 and 0 length vector, mathematically, we are using the sample standard deviation formula, which in the denominator has n-1, therefore with one observation we will have 1-1 = 0 in the denominator, dividing by 0, which is undefined.\nThe standard deviation is 0 for a carrier (e.g. YV) would mean that for all the values are the same, in this case 229. All values the same implies no variation.\n\n# Question 4\n\ndata(flights)\nflights &lt;- as.tibble(flights)\n\n# piping flights by carrier, then for each carrier calculating the average departure delay\nflights %&gt;%\n  group_by(carrier) %&gt;%\n  summarise(\n    mean_dep_delay = mean(dep_delay, na.rm = TRUE)\n  ) %&gt;%\n  arrange(mean_dep_delay) %&gt;%\n# getting the carriers along the columns and rows the average departure delay\n  pivot_wider(\n    names_from = carrier,\n    values_from = mean_dep_delay\n  )\n\n# A tibble: 1 × 16\n     US    HA    AS    AA    DL    MQ    UA    OO    VX    B6  `9E`    WN    FL\n  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1  3.78  4.90  5.80  8.59  9.26  10.6  12.1  12.6  12.9  13.0  16.7  17.7  18.7\n# ℹ 3 more variables: YV &lt;dbl&gt;, EV &lt;dbl&gt;, F9 &lt;dbl&gt;\n\n\n\n# Question 5\n\n# filtering by delay &gt; 0 and arrival &lt;= 0 \ndelayed_and_arrived_on_time &lt;- flights %&gt;%\n  filter(dep_delay &gt; 0,\n         arr_delay &lt;= 0\n  )\n\nnumber_of_flights_delayed_and_arrived_on_time &lt;- nrow(delayed_and_arrived_on_time)\nnumber_of_flights &lt;- nrow(flights)\nnumber_of_flights_delayed_and_arrived_on_time / number_of_flights\n\n[1] 0.1052391\n\n\n\n# Question 6\n# Part 1\n\ndata(airlines)\ndata(flights)\n\n# making a routes variable, 'origin' + 'dest', calculating the number of different carriers per route\nflights %&gt;%\n  mutate(routes = str_c(origin, dest, sep = \" \")) %&gt;%\n  group_by(routes) %&gt;%\n  summarise(\n    n_airlines = n_distinct(carrier),\n  ) %&gt;%\n  filter(n_airlines &gt; 1) %&gt;%\n  arrange((n_airlines))\n\n# A tibble: 128 × 2\n   routes  n_airlines\n   &lt;chr&gt;        &lt;int&gt;\n 1 EWR AUS          2\n 2 EWR BDL          2\n 3 EWR BNA          2\n 4 EWR BWI          2\n 5 EWR CHS          2\n 6 EWR CLE          2\n 7 EWR CVG          2\n 8 EWR DCA          2\n 9 EWR DEN          2\n10 EWR DFW          2\n# ℹ 118 more rows\n\n\n\n# Question 6\n# Part 2\n\nflights_routes &lt;- flights %&gt;%\n  mutate(routes = str_c(origin, dest, sep = \"-\"))\n\nmulti_airline_routes &lt;- flights_routes %&gt;%\n  group_by(routes) %&gt;%\n  filter(n_distinct(carrier) &gt; 1)\n\navg_delays &lt;- multi_airline_routes %&gt;%\n  group_by(routes, carrier) %&gt;%\n  summarise(\n    avg_arr_delay = mean(arr_delay, na.rm = TRUE),\n    .groups = \"drop\"\n  ) \n\navg_delays\n\n# A tibble: 343 × 3\n   routes  carrier avg_arr_delay\n   &lt;chr&gt;   &lt;chr&gt;           &lt;dbl&gt;\n 1 EWR-ATL 9E              -6.25\n 2 EWR-ATL DL              10.0 \n 3 EWR-ATL EV              19.5 \n 4 EWR-ATL UA              10.5 \n 5 EWR-AUS UA               4.28\n 6 EWR-AUS WN             -11.2 \n 7 EWR-BDL EV               6.78\n 8 EWR-BDL UA              22.6 \n 9 EWR-BNA EV              17.7 \n10 EWR-BNA WN              -2.13\n# ℹ 333 more rows\n\n\n\n# Question 6\n# Part 3\n\nbest_worst_arrival_airlines &lt;- avg_delays %&gt;%\n  group_by(routes) %&gt;%\n  summarise(\n    best_airline = carrier[which.min(avg_arr_delay)],\n    worst_airline = carrier[which.max(avg_arr_delay)]\n  )\n\nbest_worst_arrival_airlines\n\n# A tibble: 128 × 3\n   routes  best_airline worst_airline\n   &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;        \n 1 EWR-ATL 9E           EV           \n 2 EWR-AUS WN           UA           \n 3 EWR-BDL EV           UA           \n 4 EWR-BNA WN           EV           \n 5 EWR-BOS EV           B6           \n 6 EWR-BWI WN           EV           \n 7 EWR-CHS UA           EV           \n 8 EWR-CLE EV           UA           \n 9 EWR-CLT US           EV           \n10 EWR-CVG 9E           EV           \n# ℹ 118 more rows\n\n\n\n# Question 6\n# Part 4\n\nbest_worst_arrival_times &lt;- avg_delays %&gt;%\n  group_by(routes) %&gt;%\n  summarise(\n    best_airline = min(avg_arr_delay),\n    worst_airline = max(avg_arr_delay),\n    difference = worst_airline - best_airline\n  ) %&gt;%\n  mutate(flight_id = row_number())\n\nbest_worst_arrival_times$routes[which.max(best_worst_arrival_times$difference)]\n\n[1] \"JFK-ATL\"\n\n\n\n# Question 6\n# Part 5\n\n# carrier-level average delays on JFK-ATL\nroute_carrier_delays &lt;- avg_delays %&gt;%\n  filter(routes == \"JFK-ATL\")\n\n# simple bar plot: airlines vs average arrival delay\nbarplot(\n  route_carrier_delays$avg_arr_delay,\n  names.arg = route_carrier_delays$carrier,\n  horiz = TRUE,\n  xlab = \"Average delay (minutes)\",\n  ylab = \"Carriers\",\n  main = \"Average delay by airline on JFK-ATL\"\n)\n\n\n\n\nFrom the plot above, it can be the seen that the other 2 carriers average delay was way less, approximately under 10 minutes, from this I assume that the delay on this route was so great due to some exterior circumstances, i.e. a technical malfunction or medical emergency.\n\n# Question 7\n\n# loading dataset using code given in question\n\ndf &lt;- structure(list(id = c(\"id_1\", \"id_2\", \"id_3\", \"id_4\", \"id_5\", \n\"id_6\", \"id_7\", \"id_8\", \"id_9\", \"id_10\", \"id_11\", \"id_12\", \"id_13\", \n\"id_14\", \"id_15\", \"id_16\", \"id_17\", \"id_18\", \"id_19\", \"id_20\", \n\"id_21\", \"id_22\", \"id_23\", \"id_24\", \"id_25\", \"id_26\", \"id_27\", \n\"id_28\", \"id_29\", \"id_30\", \"id_31\", \"id_32\", \"id_33\", \"id_34\", \n\"id_35\", \"id_36\", \"id_37\", \"id_38\", \"id_39\", \"id_40\", \"id_41\", \n\"id_42\", \"id_43\", \"id_44\", \"id_45\", \"id_46\", \"id_47\", \"id_48\", \n\"id_49\", \"id_50\"), age = c(50L, 34L, 70L, 33L, 22L, 61L, 69L, \n73L, 62L, 56L, 71L, 33L, 73L, 44L, 45L, 46L, 24L, 70L, 46L, 76L, \n47L, 76L, 28L, 48L, 54L, 27L, 45L, 26L, 61L, 28L, 38L, 55L, 33L, \n36L, 62L, 58L, 72L, 31L, 34L, 51L, 61L, 64L, 26L, 28L, 60L, 29L, \n42L, 46L, 79L, 72L), gender = c(\"male\", \"male\", \"male\", \"female\", \n\"female\", \"male\", \"female\", \"male\", \"male\", \"female\", \"female\", \n\"male\", \"male\", \"female\", \"male\", \"male\", \"male\", \"male\", \"female\", \n\"male\", \"male\", \"male\", \"male\", \"female\", \"femal\", \"male\", \"female\", \n\"female\", \"female\", \"female\", \"male\", \"female\", \"female\", \"female\", \n\"male\", \"male\", \"female\", \"male\", \"female\", \"female\", \"male\", \n\"female\", \"female\", \"male\", \"male\", \"female\", \"male\", \"male\", \n\"male\", \"female\"), height = c(174.4, 197.7, 174.1, 194.5, NA, \n180.4, 170.5, 157.4, 196.8, 165.1, 153, 197.4, 186, 157.1, 177.5, \n197.7, 179.3, 170.2, 182.4, NA, 165.4, 161, 168.5, 199.2, 157.7, \n154.6, 157.1, 184.5, 181, 194.6, 183.6, 186.9, 176.1, 183, 191.1, \n189.3, 199, 172, 165.6, 170.5, 150.5, 159.2, 192.1, 161.6, 162, \n153.8, 162.3, 186.6, 192.4, 174.9), weight = c(69.4, 62.3, 55.6, \n69.5, 78.6, 60.8, 72.2, 60.9, 75.1, 67.7, 82.5, 68.7, 67.8, 76.7, \n87, 61.1, 70.6, 63.3, 81.5, 59.2, 93.2, 87.3, 83.4, 80.9, 68.6, \n76.5, 93.7, 79.1, 92, 65.6, 85.4, 63.3, 79.7, 74.1, 63.3, 78.2, \n95.7, 95.1, 63.7, 66.1, 99.3, 81, 96.9, 73.3, 70.3, 83, 57.6, \n78.6, 61.9, 98.1), blood_type = c(\"O\", \"A\", \"O\", \"O\", \"B\", \"AB\", \n\"O\", \"O\", \"O\", \"AB\", \"A\", \"O\", \"O\", \"O\", \"B\", \"A\", \"B\", \"AB\", \n\"O\", \"AB\", \"A\", \"AB\", \"O\", \"B\", \"A\", \"A\", \"B\", \"AB\", \"A\", \"B\", \n\"B\", \"A\", \"O\", \"O\", \"O\", \"B\", \"O\", \"A\", \"A\", \"B\", \"A\", \"O\", \"AB\", \n\"A\", \"A\", \"O\", \"O\", \"B\", \"A\", \"O\"), disease_status = c(\"diseased\", \n\"healthy\", \"healthy\", \"healthy\", \"healthy\", \"healthy\", \"diseased\", \n\"healthy\", \"diseased\", \"Healthy\", \"diseased\", \"healthy\", \"diseased\", \n\"healthy\", \"diseased\", \"healthy\", \"healthy\", \"healthy\", \"healthy\", \n\"healthy\", \"healthy\", \"diseased\", \"healthy\", \"diseased\", \"healthy\", \n\"healthy\", \"healthy\", \"healthy\", \"diseased\", \"diseased\", \"healthy\", \n\"healthy\", \"healthy\", \"diseased\", \"diseased\", \"diseased\", \"healthy\", \n\"diseased\", \"healthy\", \"healthy\", \"healthy\", \"healthy\", \"healthy\", \n\"diseased\", \"diseased\", \"diseased\", \"healthy\", \"healthy\", \"diseased\", \n\"diseased\"), cholesterol = c(228, 223, 213, 198, 166, 151, 195, \n199, 189, 196, 221, 156, 185, 230, 234, 174, 185, 236, 235, 180, \n165, 220, 160, 153, 250, 153, 184, 242, 212, 179, 224, 233, 181, \n199, 220, 214, 214, 248, 191, 162, 203, 173, 199, 187, 248, 189, \n173, 212, 164, 247), glucose = c(96, 78, 101, 119, 103, 91, 86, \nNA, 77, 80, 115, 85, 88, 109, NA, 71, 90, 94, 91, 87, 113, 93, \n97, 118, 109, 80, 85, 119, 99, 108, 89, 108, 97, 116, 79, 84, \n75, 81, 119, NA, 106, 109, 75, 82, 84, 75, 76, 120, 119, 77), \n    smoker = c(\"yes\", \"yes\", \"yes\", \"yes\", \"no\", \"yes\", \"no\", \n    \"yes\", \"no\", \"no\", \"no\", \"no\", \"no\", \"yes\", \"no\", \"yes\", \n    \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"yes\", \"no\", \n    \"no\", \"yes\", \"yes\", \"yes\", \"no\", \"no\", \"yes\", \"no\", \"yes\", \n    \"no\", \"yes\", \"no\", \"yes\", \"yes\", \"yes\", \"no\", \"no\", \"yes\", \n    \"no\", \"no\", \"no\", \"no\", \"no\", \"no\", \"yes\"), exercise = c(\"occasional\", \n    \"regular\", \"occasional\", \"regular\", \"none\", \"occasional\", \n    \"regular\", \"none\", \"occasional\", \"none\", \"occasional\", \"none\", \n    \"none\", \"regular\", \"occasional\", \"none\", \"regular\", \"regular\", \n    \"none\", \"occasional\", \"none\", \"occasional\", \"occasional\", \n    \"occasional\", \"regular\", \"occasional\", \"regular\", \"regular\", \n    \"regular\", \"occasional\", \"occasional\", \"none\", \"none\", \"regular\", \n    \"occasional\", \"occasional\", \"none\", \"none\", \"none\", \"none\", \n    \"occasional\", \"regular\", \"regular\", \"none\", \"regular\", \"occasional\", \n    \"occasional\", \"none\", \"occasional\", \"regular\"), income = c(84820L, \n    81547L, 22588L, 72490L, 74533L, 25338L, 41469L, 57315L, 63629L, \n    88662L, 62615L, 56261L, 58499L, 82232L, 77584L, 77275L, 38468L, \n    54510L, 91326L, 78611L, 31402L, 29586L, 21441L, 58269L, 84173L, \n    88295L, 37940L, 43750L, 69750L, 92356L, 82518L, 91455L, 68866L, \n    51178L, 68275L, 27689L, 35418L, 81318L, 62405L, 86851L, 25654L, \n    47553L, 74474L, 51409L, 22607L, 55360L, 96351L, 21516L, 41927L, \n    55810L), education = c(\"master\", \"bachelor\", \"PhD\", \"master\", \n    \"bachelor\", \"highschool\", \"PhD\", \"highschool\", \"PhD\", \"PhD\", \n    \"bachelor\", \"highschool\", \"master\", \"bachelor\", \"PhD\", \"PhD\", \n    \"PhD\", \"bachelor\", \"master\", \"highschool\", \"PhD\", \"highschool\", \n    \"bachelor\", \"master\", \"highschool\", \"highschool\", \"master\", \n    \"master\", \"bachelor\", \"PhD\", \"highschool\", \"PhD\", \"master\", \n    \"master\", \"master\", \"PhD\", \"highschool\", \"master\", \"master\", \n    \"highschool\", \"bachelor\", \"highschool\", \"bachelor\", \"PhD\", \n    \"bachelor\", \"highschool\", \"master\", \"highschool\", \"bachelor\", \n    \"bachelor\"), region = c(\"North\", \"South\", \"North\", \"West\", \n    \"North\", \"West\", \"South\", \"South\", \"West\", \"South\", \"West\", \n    \"South\", \"West\", \"East\", \"North\", \"West\", \"North\", \"North\", \n    \"West\", \"North\", \"East\", \"West\", \"South\", \"North\", \"North\", \n    \"East\", \"East\", \"North\", \"North\", \"West\", \"South\", \"West\", \n    \"West\", \"East\", \"West\", \"North\", \"West\", \"North\", \"East\", \n    \"North\", \"West\", \"South\", \"South\", \"East\", \"North\", \"West\", \n    \"West\", \"East\", \"North\", \"East\"), marital_status = c(\"divorced\", \n    \"single\", \"divorced\", \"divorced\", \"divorced\", \"divorced\", \n    \"divorced\", \"married\", \"divorced\", \"married\", \"divorced\", \n    \"widowed\", \"married\", \"single\", \"widowed\", \"widowed\", \"single\", \n    \"divorced\", \"widowed\", \"widowed\", \"single\", \"married\", \"single\", \n    \"married\", \"widowed\", \"married\", \"single\", \"single\", \"widowed\", \n    \"married\", \"widowed\", \"divorced\", \"single\", \"married\", \"single\", \n    \"widowed\", \"widowed\", \"married\", \"widowed\", \"divorced\", \"married\", \n    \"married\", \"divorced\", \"single\", \"married\", \"widowed\", \"divorced\", \n    \"divorced\", \"single\", \"divorced\")), row.names = c(NA, -50L\n), class = c(\"tbl_df\", \"tbl\", \"data.frame\"))\n\ncolSums(is.na(df)) # missing entries (i.e. 'NA')\n\n            id            age         gender         height         weight \n             0              0              0              2              0 \n    blood_type disease_status    cholesterol        glucose         smoker \n             0              0              0              3              0 \n      exercise         income      education         region marital_status \n             0              0              0              0              0 \n\n\n\n# Question 7\n# Check for inconsistiences in dataset, done by checking each variable individually and what types of values/catagories etc it should have, if not, implies inconsistent \n\n\ncheck_missing &lt;- function(x) sum(is.na(x))\n\ncheck_cat &lt;- function(x, allowed) {\n  x2 &lt;- x[!is.na(x)]\n  bad &lt;- setdiff(unique(x2), allowed)\n  list(\n    n_inconsistent = length(bad),\n    inconsistent_values = bad\n  )\n}\n\ncheck_integer &lt;- function(x) {\n  x2 &lt;- x[!is.na(x)]\n  # integer-ness check (works even if stored as numeric)\n  bad &lt;- x2[abs(x2 - round(x2)) &gt; 1e-9]\n  list(\n    n_non_integer = length(bad),\n    example_values = unique(bad)\n  )\n}\n\ncheck_numeric &lt;- function(x) {\n  list(\n    is_numeric = is.numeric(x),\n    n_missing = sum(is.na(x))\n  )\n}\n\n# 1) id: should be unique\nlist(\n  n_missing = check_missing(df$id),\n  n_duplicates = sum(duplicated(df$id[!is.na(df$id)])),\n  duplicate_values = unique(df$id[!is.na(df$id) & duplicated(df$id)])\n)\n\n$n_missing\n[1] 0\n\n$n_duplicates\n[1] 0\n\n$duplicate_values\ncharacter(0)\n\n# 2) age: should be integer\nlist(\n  n_missing = check_missing(df$age),\n  check_integer(df$age)\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_non_integer\n[1] 0\n\n[[2]]$example_values\ninteger(0)\n\n# 3) gender: should be only male/female\nlist(\n  n_missing = check_missing(df$gender),\n  check_cat(df$gender, c(\"male\", \"female\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 1\n\n[[2]]$inconsistent_values\n[1] \"femal\"\n\n# 4) height: numeric (missing values are fine to detect)\nlist(\n  n_missing = check_missing(df$height),\n  is_numeric = is.numeric(df$height)\n)\n\n$n_missing\n[1] 2\n\n$is_numeric\n[1] TRUE\n\n# 5) blood_type: \nlist(\n  n_missing = check_missing(df$blood_type),\n  check_cat(df$blood_type, c(\"A\", \"B\", \"AB\", \"O\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 0\n\n[[2]]$inconsistent_values\ncharacter(0)\n\n# 6) disease_status: \nlist(\n  n_missing = check_missing(df$disease_status),\n  check_cat(df$disease_status, c(\"healthy\", \"diseased\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 1\n\n[[2]]$inconsistent_values\n[1] \"Healthy\"\n\n# case sensitive\nlist(\n  n_missing = check_missing(df$disease_status),\n  check_cat(tolower(df$disease_status), c(\"healthy\", \"diseased\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 0\n\n[[2]]$inconsistent_values\ncharacter(0)\n\n# 7) smoker:\nlist(\n  n_missing = check_missing(df$smoker),\n  check_cat(df$smoker, c(\"yes\", \"no\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 0\n\n[[2]]$inconsistent_values\ncharacter(0)\n\n# 8) exercise: \nlist(\n  n_missing = check_missing(df$exercise),\n  check_cat(df$exercise, c(\"none\", \"occasional\", \"regular\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 0\n\n[[2]]$inconsistent_values\ncharacter(0)\n\n# 9) income: should be integer\nlist(\n  n_missing = check_missing(df$income),\n  check_integer(df$income)\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_non_integer\n[1] 0\n\n[[2]]$example_values\ninteger(0)\n\n# 10) region:\nlist(\n  n_missing = check_missing(df$region),\n  check_cat(df$region, c(\"North\", \"South\", \"East\", \"West\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 0\n\n[[2]]$inconsistent_values\ncharacter(0)\n\n# 11) marital_status:\nlist(\n  n_missing = check_missing(df$marital_status),\n  check_cat(df$marital_status, c(\"single\", \"married\", \"divorced\", \"widowed\"))\n)\n\n$n_missing\n[1] 0\n\n[[2]]\n[[2]]$n_inconsistent\n[1] 0\n\n[[2]]$inconsistent_values\ncharacter(0)"
  }
]